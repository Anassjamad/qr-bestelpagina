<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
    <title>Kiosk ‚Äì Bestellen</title>
    <link href="https://fonts.googleapis.com/css2?family=Rubik:wght@400;500;600;700&display=swap" rel="stylesheet" />
    <style>
        :root {
            --bg: #f4fdf7;
            --fg: #0b1a12;
            --brand: #4caf50;
            --brand-700: #388e3c;
            --muted: #8aa398;
            --card: #ffffff;
            --shadow: 0 10px 30px rgba(0,0,0,.10);
            --radius: 18px;
            --radius-lg: 28px;
            --elev: 0 15px 40px rgba(56,142,60,.25);
        }

        * {
            box-sizing: border-box
        }

        html, body {
            height: 100%
        }

        body {
            font-family: 'Rubik',sans-serif;
            margin: 0;
            background: var(--bg);
            color: var(--fg);
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
        }

        .wrap {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 24px;
        }

        .top {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
        }

        .brand {
            display: flex;
            align-items: center;
            gap: 12px;
            font-weight: 700;
        }

            .brand .dot {
                width: 14px;
                height: 14px;
                border-radius: 50%;
                background: var(--brand);
            }

        .badge {
            background: rgba(76,175,80,.12);
            color: var(--brand-700);
            padding: 10px 14px;
            border-radius: 14px;
            font-weight: 600;
            font-size: 15px;
        }

        .note {
            text-align: center;
            color: var(--muted);
            margin-bottom: 10px;
        }

        /* --- STAGE --- */
        .stage {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 22px;
            margin-top: 12px;
            margin-bottom: 26px;
            pointer-events: auto;
        }

        .card {
            background: var(--card);
            border-radius: var(--radius);
            padding: 26px;
            box-shadow: var(--shadow);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 14px;
            font-size: 30px;
            font-weight: 700;
            cursor: pointer;
            user-select: none;
            transition: transform .2s, box-shadow .2s;
            animation: pop .5s ease forwards;
        }

            .card:hover {
                transform: translateY(-4px);
            }

            .card:active {
                transform: scale(.97);
            }

            .card svg {
                width: 36px;
                height: 36px;
            }

            .card.selected {
                box-shadow: var(--elev);
                background: #e8f5e9;
            }

        /* --- GRID --- */
        .grid {
            display: grid;
            grid-template-columns: repeat(3,1fr);
            gap: 22px;
            margin-top: 8px;
        }

        .product {
            background: var(--card);
            border-radius: var(--radius);
            padding: 18px;
            box-shadow: var(--shadow);
            display: flex;
            flex-direction: column;
            gap: 12px;
            transform: translateY(12px);
            opacity: 0;
            animation: rise .5s ease forwards;
        }

        .p-img {
            width: 100%;
            height: 170px;
            border-radius: 14px;
            object-fit: cover;
            background: #e8efe9;
        }

        .p-name {
            font-weight: 700;
            font-size: 20px;
        }

        .p-price {
            font-weight: 700;
            color: var(--brand-700);
        }

        .qty {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 10px;
            background: #f1fbf4;
            border-radius: 12px;
            padding: 10px 12px;
        }

        .btn-icon {
            width: 44px;
            height: 44px;
            border-radius: 12px;
            border: none;
            cursor: pointer;
            display: grid;
            place-items: center;
            background: var(--brand);
            color: #fff;
            font-size: 22px;
            font-weight: 700;
        }

            .btn-icon:active {
                transform: scale(.95);
            }

        .note-input {
            width: 100%;
            padding: 12px 14px;
            border-radius: 12px;
            border: 1.5px solid #e1eee4;
            font-size: 15px;
            display: none;
        }

        /* --- BAR --- */
        .bar {
            position: sticky;
            bottom: 0;
            padding: 14px 24px;
            margin-top: 18px;
            background: linear-gradient(180deg, rgba(244,253,247,.0), rgba(244,253,247,1) 35%);
        }

            .bar .inner {
                max-width: 1200px;
                margin: 0 auto;
                background: #ffffff;
                border-radius: var(--radius-lg);
                box-shadow: var(--elev);
                padding: 14px;
                display: flex;
                gap: 12px;
                align-items: center;
                justify-content: space-between;
            }

        .pill {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px 16px;
            border-radius: 999px;
            background: #f1fbf4;
            color: #276f2b;
            font-weight: 700;
        }

        .primary {
            border: none;
            padding: 16px 24px;
            border-radius: 16px;
            background: var(--brand);
            font-size: 18px;
            color: #fff;
            font-weight: 800;
            cursor: pointer;
            min-width: 260px;
        }

        /* --- DRAWER --- */
        .drawer {
            position: fixed;
            right: 24px;
            top: 24px;
            width: 420px;
            max-width: 92vw;
            background: #ffffff;
            border-radius: 22px;
            box-shadow: 0 30px 60px rgba(0,0,0,.25);
            padding: 18px;
            display: none;
            z-index: 30;
            animation: fadeIn .25s ease forwards;
        }

        .line {
            display: flex;
            align-items: flex-start;
            justify-content: space-between;
            gap: 10px;
            padding: 10px 0;
            border-bottom: 1px dashed #e6efe9;
        }

        .muted {
            color: var(--muted);
            font-size: 14px;
        }

        .pay {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        .ghost {
            border: 2px solid #e2efe6;
            padding: 14px 16px;
            border-radius: 14px;
            background: #fff;
            font-weight: 700;
            cursor: pointer;
            flex: 1;
        }

        .pay .primary {
            flex: 2;
        }

        /* --- OVERLAY --- */
        .overlay {
            position: fixed;
            inset: 0;
            background: rgba(255,255,255,.92);
            display: none;
            z-index: 50;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            gap: 20px;
        }

        .spinner {
            width: 88px;
            height: 88px;
            border-radius: 999px;
            border: 10px solid #eaf5ec;
            border-top-color: var(--brand);
            animation: spin 1s linear infinite;
        }

        .toast {
            position: fixed;
            left: 50%;
            transform: translateX(-50%);
            bottom: 24px;
            background: var(--fg);
            color: #fff;
            padding: 14px 18px;
            border-radius: 12px;
            font-weight: 600;
            display: none;
            z-index: 60;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg)
            }
        }

        @keyframes fadeIn {
            from {
                opacity: 0
            }

            to {
                opacity: 1
            }
        }

        @keyframes pop {
            from {
                opacity: 0;
                transform: scale(.95)
            }

            to {
                opacity: 1;
                transform: scale(1)
            }
        }

        @keyframes rise {
            from {
                opacity: 0;
                transform: translateY(18px)
            }

            to {
                opacity: 1;
                transform: translateY(0)
            }
        }

        @media (max-width:900px) {
            .grid {
                grid-template-columns: repeat(2,1fr)
            }

            .stage {
                grid-template-columns: 1fr
            }
        }
    </style>
</head>
<body>
    <div class="wrap">
        <div class="top">
            <div class="brand"><span class="dot"></span><div>OA Logica ‚Äì Bestellen</div></div>
            <div id="kioskBadge" class="badge">Kiosk #‚Äì</div>
        </div>

        <div class="note">Kies hoe je wilt bestellen</div>
        <div class="stage" id="orderTypeStage">
            <div id="btnPickup" class="card pickup">üçΩÔ∏è Ter plaatse eten</div>
            <div id="btnTakeaway" class="card takeaway">üõçÔ∏è Afhalen</div>
        </div>

        <div id="productsWrap" style="display:none; pointer-events:none;">
            <h2 style="margin:8px 0 6px 0;">Kies je producten</h2>
            <div id="products" class="grid"></div>
            <div class="bar">
                <div class="inner">
                    <div class="pill"><span id="cartCount">0</span> items ‚Ä¢ <span id="cartTotal">‚Ç¨0,00</span></div>
                    <button id="btnOverview" class="primary">Verder naar overzicht</button>
                </div>
            </div>
        </div>

        <div id="drawer" class="drawer">
            <h3>Overzicht</h3>
            <div id="summary"></div>
            <div class="pay">
                <button id="btnBack" class="ghost">Terug</button>
                <button id="btnPay" class="primary">Betalen</button>
            </div>
        </div>
    </div>

    <div id="loading" class="overlay">
        <div class="spinner"></div>
        <div>Wachten op betaling...</div>
    </div>
    <div id="toast" class="toast"></div>

    <script>
        const backendUrl = 'https://bestel-backend.onrender.com';
        const kiosk = new URLSearchParams(window.location.search).get('kiosk') || '‚Äì';
        document.getElementById('kioskBadge').textContent = `Kiosk #${kiosk}`;

        const btnPickup = document.getElementById('btnPickup');
        const btnTakeaway = document.getElementById('btnTakeaway');
        const stage = document.getElementById('orderTypeStage');
        const productsWrap = document.getElementById('productsWrap');
        const products = document.getElementById('products');

        let orderType = null;

        btnPickup.onclick = () => chooseType('pickup');
        btnTakeaway.onclick = () => chooseType('takeaway');

        function chooseType(type) {
            orderType = type;
            btnPickup.classList.toggle('selected', type === 'pickup');
            btnTakeaway.classList.toggle('selected', type === 'takeaway');
            stage.style.pointerEvents = 'none';
            productsWrap.style.pointerEvents = 'auto';
            productsWrap.style.display = '';
            loadProducts();
        }

        async function loadProducts() {
            try {
                const res = await fetch(`${backendUrl}/products`);
                const data = await res.json();
                products.innerHTML = data.map(p => `
              <div class="product">
                <img class="p-img" src="${p.image || 'https://via.placeholder.com/100'}">
                <div class="p-name">${p.naam}</div>
                <div class="p-price">‚Ç¨${p.prijs.toFixed(2)}</div>
              </div>`).join('');
            } catch (e) {
                alert('Kan producten niet laden.');
            }
        }
    </script>
</body>
</html>
